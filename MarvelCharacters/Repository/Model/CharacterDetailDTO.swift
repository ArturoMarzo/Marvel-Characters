import UIKit

struct CharacterDetailDTO {
    let id: UInt
    let name: String
    let description: String?
    let thumbnail: String?
    let comics: [CharacterDetailComicDTO]?
    let availableComics: Int
    let series: [CharacterDetailSerieDTO]?
    let availableSeries: Int
    let stories: [CharacterDetailStoryDTO]?
    let availableStories: Int
    
    // Receives the struct generated by the user service parser
    init?(characterDetailEntity: CharacterDetailEntity) {
        guard let id  = characterDetailEntity.id, let name = characterDetailEntity.name else { return nil }
        self.id = id
        self.name = name
        description = characterDetailEntity.description
        if let path = characterDetailEntity.thumbnail?.path,
            let extensionFile = characterDetailEntity.thumbnail?.extensionFile {
            thumbnail = "\(path).\(extensionFile)"
        } else {
            thumbnail = nil
        }
        
        if let comics = characterDetailEntity.comics?.items {
            var comicsDTO = [CharacterDetailComicDTO]()
            for comic in comics {
                comicsDTO.append(CharacterDetailComicDTO(name: comic.name))
            }
            self.comics = comicsDTO
            self.availableComics = characterDetailEntity.comics?.available ?? 0
        } else {
            self.comics = [CharacterDetailComicDTO]()
            self.availableComics = 0
        }
        
        if let series = characterDetailEntity.series?.items {
            var seriesDTO = [CharacterDetailSerieDTO]()
            for serie in series {
                seriesDTO.append(CharacterDetailSerieDTO(name: serie.name))
            }
            self.series = seriesDTO
            self.availableSeries = characterDetailEntity.series?.available ?? 0
        } else {
            self.series = [CharacterDetailSerieDTO]()
            self.availableSeries = 0
        }
        
        if let storys = characterDetailEntity.stories?.items {
            var storiesDTO = [CharacterDetailStoryDTO]()
            for story in storys {
                storiesDTO.append(CharacterDetailStoryDTO(name: story.name))
            }
            self.stories = storiesDTO
            self.availableStories = characterDetailEntity.stories?.available ?? 0
        } else {
            self.stories = [CharacterDetailStoryDTO]()
            self.availableStories = 0
        }
    }
}

struct CharacterDetailComicDTO {
    let name: String
}

struct CharacterDetailSerieDTO {
    let name: String
}

struct CharacterDetailStoryDTO {
    let name: String
}
